<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
        integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />
    <!--<link rel="stylesheet" href="style.css" /> -->
    <title></title>
</head>

<body>
    <h1 class="display-6 bg-dark text-white text-center font-weight-bold" style="padding:20px; margin-bottom:0px">
        Weather Dashboard</h1>

    <div class="container col-4 float-left border bg-light">
        <p class="text-dark font-weight-bold">Search for a City:</p>
        <div class="input-group-append" style="width:80%">
            <input type="text" id="cityInput" class="form-control text-area">
            <button type="button" id="cityInputSearch" class="btn btn-primary border border-primary"
                style=" border-width:1px !important; margin-bottom: 10px"><i
                    class="fas fa-search-location"></i></button>
        </div>

        <nav class="nav flex-column" id="recentCities" style="margin-bottom: 10px">
            <!--<a class="nav-link border rounded" href="#" style="background-color:white; color:gray; display:none">City</a> -->
            <!--<a class="nav-link" id ="0" href="#" style="background-color:white; color:gray"><span></span></a> -->
        </nav>
    </div>

    <div class="card">
        <div class="card-body">
            <h4 class="card-title font-weight-bold" id="currentCity">
                <p id="currentDay"></p>
            </h4>
        </div>
        <ul class="list-group list-group-flush">
            <li class="list-group-item border-0" id="currentTemperature"></li>
            <li class="list-group-item border-0" id="currentHumidity"></li>
            <li class="list-group-item border-0" id="currentWindSpeed"></li>
            <li class="list-group-item border-0" id="currentUVIndex"></li>
        </ul>
    </div>

    <div style="margin-top:10px">
        <h4>5 Day Forecast</h4>
        <div class="row" style="color:white ">
            <div class="">
                <div class="card" style="background-color: #007bff!important; margin:15px 15px 15px 0px">
                    <div class="card-body">
                        <p class="card-text font-weight-bold">08/14/2020</p>
                    </div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item border-0" style="background-color: #007bff!important">Temp: 86.84* F
                        </li>
                        <li class="list-group-item border-0" style="background-color: #007bff!important">Humidity: 33%
                        </li>
                </div>
            </div>
            <div class="">
                <div class="card" style="background-color: #007bff!important; margin:15px 15px 15px 0px">
                    <div class="card-body">
                        <p class="card-text font-weight-bold">08/14/2020</p>
                    </div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item border-0" style="background-color: #007bff!important">Temp: 86.84* F
                        </li>
                        <li class="list-group-item border-0" style="background-color: #007bff!important">Humidity: 33%
                        </li>
                </div>
            </div>
            <div class="">
                <div class="card" style="background-color: #007bff!important; margin:15px 15px 15px 0px">
                    <div class="card-body">
                        <p class="card-text font-weight-bold">08/14/2020</p>
                    </div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item border-0" style="background-color: #007bff!important">Temp: 86.84* F
                        </li>
                        <li class="list-group-item border-0" style="background-color: #007bff!important">Humidity: 33%
                        </li>
                </div>
            </div>
            <div class="">
                <div class="card" style="background-color: #007bff!important; margin:15px 15px 15px 0px">
                    <div class="card-body">
                        <p class="card-text font-weight-bold">08/14/2020</p>
                    </div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item border-0" style="background-color: #007bff!important">Temp: 86.84* F
                        </li>
                        <li class="list-group-item border-0" style="background-color: #007bff!important">Humidity: 33%
                        </li>
                </div>
            </div>
            <div class="">
                <div class="card" style="background-color: #007bff!important; margin:15px 0px 15px 0px">
                    <div class="card-body">
                        <p class="card-text font-weight-bold">08/14/2020</p>
                    </div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item border-0" style="background-color: #007bff!important">Temp: 86.84* F
                        </li>
                        <li class="list-group-item border-0" style="background-color: #007bff!important">Humidity: 33%
                        </li>
                </div>
            </div>
        </div>


    </div>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js">
    </script>
    <script src="style.js"></script>
    <script type="text/javascript">

        for (var i = 0; i < 10; i++) {
            var recentCityLocalStorage = localStorage.getItem(i)
            if (recentCityLocalStorage !== null) {
                var setPastCities = $("<a>")
                setPastCities.text(recentCityLocalStorage)
                $("#recentCities").prepend(setPastCities)
            }
            else {
                localStorage.setItem(i, "")
            }
        }

        var j = 0
        $("#cityInputSearch").on("click", function (event) {
            event.preventDefault();
            var city = $("#cityInput").val();
            console.log(city);

            var newImage = $("<a>");
            newImage.text(city);
            $("#recentCities").prepend(newImage);
            localStorage.setItem(j, city);
            j++
        


            var APIKey = "83244185ec907e431bce5c00d753e3e9";
            var queryURL = "https://api.openweathermap.org/data/2.5/weather?q="
            var appId = "&appid="
            //var city = "Charlotte"
            var currentCitySearch = queryURL + city + appId + APIKey;
            var image = $("<img>").attr("src", "http://openweathermap.org/img/wn/10d@2x.png")


            $.ajax({
                url: currentCitySearch,
                method: "GET"
            }).then(function (response) {

                console.log(response);
                var k = (response.main.temp);
                var f = (k - 273.15) * 1.80 + 32;
                $("#currentCity").text(city + " " + moment().format(("(M/DD/YYYY)"))).append(image);
                $("#currentTemperature").text("Temperature: " + f.toFixed(2) + " \u00B0" + "F");
                $("#currentHumidity").text("Humidity: " + response.main.humidity + "%");
                $("#currentWindSpeed").text("Wind Speed: " + response.wind.speed + " MPH");
                var lat = response.coord.lat;
                var lon = response.coord.lon;
                $("#currentUVIndex").text("UV Index: ")

                var queryURLUV = 'http://api.openweathermap.org/data/2.5/uvi?appid=' + APIKey + '&lat=' + lat + '&lon=' + lon

                $.ajax({
                    url: queryURLUV,
                    method: "GET"
                }).then(function (response) {
                    console.log(response);

                    $("#currentUVIndex").text("UV Index: " + response.value)
                });

            });
        })


    </script>

</body>

</html>